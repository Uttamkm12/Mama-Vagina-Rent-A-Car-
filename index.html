<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mama Vagina Rent-A-Car</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #fff; margin: 0; padding: 15px; text-align: center; }
        .header { font-size: 32px; font-weight: bold; margin-bottom: 5px; }
        .sub-header { color: #e91e63; font-size: 14px; text-align: left; font-weight: bold; margin-bottom: 10px; }
        
        /* Schedule List */
        .schedule-container { margin-bottom: 100px; }
        .booking-row {
            background: #ff0000; color: white; display: flex; 
            justify-content: space-around; padding: 10px 5px; 
            margin-bottom: 5px; border-radius: 4px; font-size: 12px; font-weight: bold;
        }
        
        /* Buttons */
        .footer-btns {
            position: fixed; bottom: 20px; left: 0; width: 100%;
            display: flex; justify-content: space-around;
        }
        .nav-btn {
            background: #4dfd82; border: none; padding: 10px 20px;
            border-radius: 10px; font-weight: bold; font-size: 16px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); color: #fff; text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        /* Modal Overlay */
        #add-form-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; display: none; padding: 20px; box-sizing: border-box; z-index: 1000;
        }
        .form-group { text-align: left; margin-bottom: 15px; }
        input { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 16px; }
        .save-btn { background: #0088cc; color: white; border: none; padding: 15px; width: 100%; border-radius: 8px; font-weight: bold; font-size: 18px; cursor: pointer; }
        .close-btn { background: #666; margin-top: 10px; }
    </style>
</head>
<body>

    <div class="header">মামা ভাগিনা রেন্ট এ কার</div>
    <div class="sub-header">বুকড শিডিউল</div>

    <div class="schedule-container" id="scheduleList">
        <p>লোড হচ্ছে...</p>
    </div>

    <div class="footer-btns">
        <button class="nav-btn">আয় ও ব্যয়</button>
        <button class="nav-btn" onclick="openAddForm()">সিডিউল এড</button>
    </div>

    <div id="add-form-overlay">
        <h2>নতুন সিডিউল</h2>
        <div class="form-group">
            <label>তারিখ (অটোমেটিক):</label>
            <input type="text" id="bookDate" readonly>
        </div>
        <div class="form-group">
            <label>সময় (অটোমেটিক):</label>
            <input type="text" id="bookTime" readonly>
        </div>
        <div class="form-group">
            <label>রুট (কোথা থেকে - কোথায়):</label>
            <input type="text" id="bookRoute" placeholder="উদা: ঢাকা - খুলনা">
        </div>
        <div class="form-group">
            <label>যাত্রীর মোবাইল নম্বর:</label>
            <input type="number" id="passengerPhone" placeholder="মোবাইল নম্বর লিখুন">
        </div>
        <button class="save-btn" id="finalSaveBtn" onclick="submitSchedule()">সেভ করুন</button>
        <button class="save-btn close-btn" onclick="closeAddForm()">বন্ধ করুন</button>
    </div>

    <script>
        const scriptURL = 'আপনার_গুগল_স্ক্রিপ্ট_লিঙ্ক_এখানে';

        window.onload = loadSchedules;

        function openAddForm() {
            // অটোমেটিক বর্তমান তারিখ ও সময় সেট করা
            const now = new Date();
            const dateStr = now.toLocaleDateString('bn-BD'); // বাংলা তারিখ ফরম্যাট
            const timeStr = now.toLocaleTimeString('bn-BD', { hour: '2-digit', minute: '2-digit' });

            document.getElementById('bookDate').value = dateStr;
            document.getElementById('bookTime').value = timeStr;
            document.getElementById('add-form-overlay').style.display = 'block';
        }

        function closeAddForm() {
            document.getElementById('add-form-overlay').style.display = 'none';
        }

        async function loadSchedules() {
            const listContainer = document.getElementById('scheduleList');
            try {
                const response = await fetch(scriptURL);
                const data = await response.json();
                listContainer.innerHTML = '';
                
                data.forEach(item => {
                    if(item.status === 'Booked') {
                        const row = document.createElement('div');
                        row.className = 'booking-row';
                        row.innerHTML = `
                            <span>${item.day || 'রবিবার'}</span>
                            <span>${item.date}</span>
                            <span>${item.time}</span>
                            <span>${item.route}</span>
                            <span>${item.phone}</span>
                        `;
                        listContainer.appendChild(row);
                    }
                });
            } catch (e) {
                listContainer.innerHTML = '<p>কোন ডাটা পাওয়া যায়নি</p>';
            }
        }

        async function submitSchedule() {
            const btn = document.getElementById('finalSaveBtn');
            const phone = document.getElementById('passengerPhone').value;
            
            if(!phone) { alert("মোবাইল নম্বর দিন!"); return; }

            btn.disabled = true;
            btn.innerText = "সেভ হচ্ছে...";

            const data = {
                date: document.getElementById('bookDate').value,
                time: document.getElementById('bookTime').value,
                route: document.getElementById('bookRoute').value,
                phone: phone,
                status: 'Booked'
            };

            try {
                await fetch(scriptURL, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: JSON.stringify(data)
                });
                alert("সফলভাবে সেভ হয়েছে!");
                closeAddForm();
                loadSchedules();
            } catch (e) {
                alert("ভুল হয়েছে!");
            } finally {
                btn.disabled = false;
                btn.innerText = "সেভ করুন";
            }
        }
    </script>
</body>
</html>
