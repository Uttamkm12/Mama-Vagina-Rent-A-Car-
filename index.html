<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mama Vagina Rent-A-Car</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: Arial, sans-serif; background: #fff; margin: 0; padding: 10px; text-align: center; }
        .header { font-size: 26px; font-weight: bold; margin-bottom: 10px; }
        .booking-row { color: white; display: flex; justify-content: space-around; padding: 10px; margin-bottom: 5px; border-radius: 5px; font-size: 11px; font-weight: bold; }
        .bg-red { background: #ff0000; } 
        .bg-green { background: #27ae60; }
        .nav-btn { background: #4dfd82; border: none; padding: 12px 20px; border-radius: 10px; font-weight: bold; font-size: 14px; color: #fff; cursor: pointer; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; display: none; padding: 20px; box-sizing: border-box; overflow-y: auto; text-align: left; z-index: 10; }
        input, select { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; }
        .save-btn { background: #0088cc; color: white; border: none; padding: 15px; width: 100%; border-radius: 8px; font-weight: bold; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="header">‡¶Æ‡¶æ‡¶Æ‡¶æ ‡¶≠‡¶æ‡¶ó‡¶ø‡¶®‡¶æ ‡¶∞‡ßá‡¶®‡ßç‡¶ü ‡¶è ‡¶ï‡¶æ‡¶∞</div>
    <div id="scheduleList"><p>‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p></div>

    <div style="position:fixed; bottom:20px; width:100%; display:flex; justify-content:space-around; left:0;">
        <button class="nav-btn" onclick="showForm('finance-form')">‡¶Ü‡¶Ø‡¶º ‡¶ì ‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º</button>
        <button class="nav-btn" onclick="showForm('schedule-form')">‡¶∏‡¶ø‡¶°‡¶ø‡¶â‡¶≤ ‡¶è‡¶°</button>
    </div>

    <div id="finance-form" class="overlay">
        <h3>üí∞ ‡¶Ü‡¶Ø‡¶º ‡¶ì ‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø</h3>
        <label>‡¶ß‡¶∞‡¶®:</label>
        <select id="finType">
            <option value="Income">‡¶Ü‡ßü (‡¶≠‡¶æ‡ßú‡¶æ)</option>
            <option value="Expense">‡¶¨‡ßç‡¶Ø‡ßü (‡¶ñ‡¶∞‡¶ö)</option>
        </select>
        <input type="number" id="finAmount" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£">
        <input type="text" id="finNote" placeholder="‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶®‡ßã‡¶ü">
        <button class="save-btn" onclick="saveFinance()">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        <button class="save-btn" style="background:#666" onclick="hideForms()">‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>

    <div id="schedule-form" class="overlay">
        <h3>üìÖ ‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡ßÅ‡¶ï‡¶ø‡¶Ç</h3>
        <input type="date" id="bookDate" onchange="updateDay()">
        <input type="text" id="bookDay" readonly placeholder="‡¶¨‡¶æ‡¶∞ (‡¶Ö‡¶ü‡ßã)">
        <div style="display:flex; gap:5px;">
            <select id="hour"></select><select id="min"></select>
            <select id="ampm"><option>AM</option><option>PM</option></select>
        </div>
        <input type="text" id="route" placeholder="‡¶ó‡¶®‡ßç‡¶§‡¶¨‡ßç‡¶Ø (‡¶ï‡ßã‡¶•‡¶æ ‡¶•‡ßá‡¶ï‡ßá - ‡¶ï‡ßã‡¶•‡¶æ‡ßü)">
        <input type="number" id="phone" placeholder="‡¶Ø‡¶æ‡¶§‡ßç‡¶∞‡ßÄ‡¶∞ ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤">
        <input type="number" id="advance" placeholder="‡¶è‡¶°‡¶≠‡¶æ‡¶®‡ßç‡¶∏ (‡ß≥)">
        <button class="save-btn" onclick="saveSchedule()">‡¶∏‡ßá‡¶≠ ‡¶¨‡ßÅ‡¶ï‡¶ø‡¶Ç</button>
        <button class="save-btn" style="background:#666" onclick="hideForms()">‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>

    <script>
        const scriptURL = '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞_‡¶®‡¶§‡ßÅ‡¶®_URL_‡¶è‡¶ñ‡¶æ‡¶®‡ßá';

        window.onload = function() {
            const h = document.getElementById('hour');
            const m = document.getElementById('min');
            for(let i=1; i<=12; i++) h.innerHTML += `<option>${i}</option>`;
            for(let i=0; i<=59; i++) m.innerHTML += `<option>${i<10?'0'+i:i}</option>`;
            loadData();
        };

        function showForm(id) { document.getElementById(id).style.display = 'block'; }
        function hideForms() { document.querySelectorAll('.overlay').forEach(f => f.style.display = 'none'); }

        function updateDay() {
            const d = new Date(document.getElementById('bookDate').value);
            const days = ['‡¶∞‡ßã‡¶¨‡¶¨‡¶æ‡¶∞', '‡¶∏‡ßã‡¶Æ‡¶¨‡¶æ‡¶∞', '‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤‡¶¨‡¶æ‡¶∞', '‡¶¨‡ßÅ‡¶ß‡¶¨‡¶æ‡¶∞', '‡¶¨‡ßÉ‡¶π‡¶∏‡ßç‡¶™‡¶§‡¶ø‡¶¨‡¶æ‡¶∞', '‡¶∂‡ßÅ‡¶ï‡ßç‡¶∞‡¶¨‡¶æ‡¶∞', '‡¶∂‡¶®‡¶ø‡¶¨‡¶æ‡¶∞'];
            document.getElementById('bookDay').value = days[d.getDay()];
        }

        async function loadData() {
            try {
                const res = await fetch(scriptURL);
                const data = await res.json();
                const list = document.getElementById('scheduleList');
                list.innerHTML = '';
                data.forEach(item => {
                    const color = item.status === 'Paid' ? 'bg-green' : 'bg-red';
                    list.innerHTML += `<div class="booking-row ${color}">
                        <span>${item.day}</span><span>${item.date}</span><span>${item.time}</span><span>${item.route}</span><span>${item.phone}</span>
                    </div>`;
                });
            } catch(e) { document.getElementById('scheduleList').innerHTML = '‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡ßü‡¶®‡¶ø‡•§'; }
        }

        async function saveFinance() {
            const data = {
                action: "save_finance",
                type: document.getElementById('finType').value,
                amount: document.getElementById('finAmount').value,
                note: document.getElementById('finNote').value
            };
            await send(data);
        }

        async function saveSchedule() {
            const data = {
                action: "save_schedule",
                day: document.getElementById('bookDay').value,
                date: document.getElementById('bookDate').value,
                time: document.getElementById('hour').value + ":" + document.getElementById('min').value + " " + document.getElementById('ampm').value,
                route: document.getElementById('route').value,
                phone: document.getElementById('phone').value,
                advance: document.getElementById('advance').value
            };
            await send(data);
        }

        async function send(data) {
            await fetch(scriptURL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(data) });
            alert("‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡ßá‡¶≠ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
            location.reload();
        }
    </script>
</body>
</html>
